<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ‰‹æœºç›¸æœºäº¤äº’</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-black flex flex-col items-center justify-center min-h-screen p-4 text-white">

    <div class="w-full max-w-md space-y-6">
        <h1 class="text-xl text-center font-light tracking-widest">CAMERA INTERACTION</h1>

        <div class="relative overflow-hidden rounded-3xl bg-gray-900 aspect-[3/4] shadow-2xl border border-gray-800">
            <video id="video" autoplay playsinline class="w-full h-full object-cover"></video>
            <canvas id="canvas" class="hidden absolute inset-0 w-full h-full object-cover"></canvas>
        </div>

        <div class="flex flex-col gap-4">
            <button onclick="startCamera()" id="startBtn" class="bg-white text-black py-4 rounded-full font-bold active:scale-95 transition">
                å¼€å¯æ‘„åƒå¤´
            </button>
            
            <div id="actionBtns" class="hidden flex gap-2">
                <button onclick="takePhoto()" class="flex-1 bg-blue-500 py-4 rounded-full font-bold active:scale-95 transition">
                    ğŸ“¸ æ‹ç…§
                </button>
                <button onclick="resetCamera()" class="flex-1 bg-gray-700 py-4 rounded-full font-bold active:scale-95 transition">
                    é‡ç½®
                </button>
            </div>
        </div>
    </div>

    <script>
        const video = document.getElementById('video');
        const canvas = document.getElementById('canvas');
        const startBtn = document.getElementById('startBtn');
        const actionBtns = document.getElementById('actionBtns');

        // å¯åŠ¨æ‘„åƒå¤´
        async function startCamera() {
            try {
                // constraints æŒ‡å®šè°ƒç”¨åç½®æ‘„åƒå¤´
                const stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { facingMode: "environment" }, 
                    audio: false 
                });
                video.srcObject = stream;
                startBtn.classList.add('hidden');
                actionBtns.classList.remove('hidden');
            } catch (err) {
                alert("æ— æ³•è®¿é—®æ‘„åƒå¤´ï¼Œè¯·ç¡®ä¿ä½¿ç”¨äº† HTTPS è®¿é—®å¹¶æˆäºˆäº†æƒé™ã€‚");
                console.error(err);
            }
        }

        // æ‹ç…§åŠŸèƒ½
        function takePhoto() {
            const context = canvas.getContext('2d');
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            context.drawImage(video, 0, 0, canvas.width, canvas.height);
            
            video.classList.add('hidden');
            canvas.classList.remove('hidden');
        }

        // é‡ç½®
        function resetCamera() {
            video.classList.remove('hidden');
            canvas.classList.add('hidden');
        }
    </script>
</body>
</html>
